rule Eternity_NET {
    meta:
        description = "Detects the Eternity stealer written in .NET"
        author = "Katie Jennings"
        date = "2024/04/01"
    strings:
        $magic_bytes = { 4D 5A } // magic bytes for windows executables
        $mscoree_dll = "mscoree.dll" wide // import for .NET
        $domain1 = "eternitypr.net" nocase
        $domain2 = "eterprx.net" nocase
    condition:
        $magic_bytes at 0 and $mscoree_dll and
        $domain1 and $domain2
}
